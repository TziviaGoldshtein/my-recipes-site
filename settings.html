<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Display Settings</title>
<style>
body {
    font-family: Poppins, sans-serif; 
    margin: 0; 
    height: 100vh; 
    display: flex; 
    flex-direction: column; 
    justify-content: center; 
    align-items: center; 
    background: #ffffff; /* default light background */ 
    transition: background 0.3s, color 0.3s;
}

h1 { 
    text-align: center; 
    margin-bottom: 2rem;
}

.settings-box { 
    background: #ffffff; /* light mode box */ 
    padding: 2rem; 
    border-radius: 20px; 
    box-shadow: 0 4px 15px rgba(0,0,0,0.2); 
    display: flex; 
    flex-direction: column; 
    align-items: center; 
    min-width: 300px; 
    transition: background 0.3s, color 0.3s;
}

label { 
    display: block; 
    margin: 1rem 0 0.5rem 0;
}

input, select { 
    padding: 0.5rem; 
    border-radius: 10px; 
    border: 1px solid #ccc; 
    width: 100%; 
    box-sizing: border-box;
}

button { 
    background: #76c893; 
    color: white; 
    border: none; 
    padding: 0.8rem 1.5rem; 
    border-radius: 25px; 
    cursor: pointer; 
    margin-top: 1rem; 
    width: 100%; 
    transition: 0.3s;
}

button:hover { background:#52b69a; }

body.dark-mode { 
    background: #121212; /* dark background */ 
    color: #f5f5f5;
}

body.dark-mode .settings-box { 
    background: #1e1e1e; /* dark box */ 
    color: #f5f5f5;
}
</style>
</head>
<body>

<h1>Display Settings</h1>

<div class="settings-box"> 
    Theme: 
    <select id="themeSelect"> 
        <option value="light">Light</option> 
        <option value="dark">Dark</option> 
    </select> 

    <label>Font size: 
        <input type="number" id="fontSizeInput" value="16"> 
    </label> 

    <label>Reading speed: 
        <input type="number" step="0.1" id="speedInput" value="0.8">  <!-- Updated default -->
    </label> 

    <button id="saveSettingsBtn">üíæ Save Settings</button> 
    <button onclick="window.history.back()">‚¨ÖÔ∏è Back</button>
</div>

<script>
const defaultSettings = { theme: "light", fontSize: 16, speed: 0.8 }; // Ensure consistency in defaults
let userSettings = JSON.parse(localStorage.getItem("userSettings")) || defaultSettings;

// Set initial values
document.getElementById("themeSelect").value = userSettings.theme;
document.getElementById("fontSizeInput").value = userSettings.fontSize;
document.getElementById("speedInput").value = userSettings.speed;

// Apply settings to body
function applySettings() {
    document.body.style.fontSize = document.getElementById("fontSizeInput").value + "px"; 
    const theme = document.getElementById("themeSelect").value; 
    if (theme === "dark") { 
        document.body.classList.add("dark-mode"); 
    } else { 
        document.body.classList.remove("dark-mode"); 
    }
}

// Live preview on input change
document.getElementById("themeSelect").addEventListener("change", () => {
    applySettings();
});
document.getElementById("fontSizeInput").addEventListener("input", () => {
    applySettings();
});

// Save settings
document.getElementById("saveSettingsBtn").addEventListener("click", () => {
    userSettings.theme = document.getElementById("themeSelect").value;
    userSettings.fontSize = parseInt(document.getElementById("fontSizeInput").value);
    userSettings.speed = parseFloat(document.getElementById("speedInput").value);
    
    localStorage.setItem("userSettings", JSON.stringify(userSettings));
    alert("Settings saved! They apply to your pages only.");
    
    // Trigger storage event to notify other pages
    window.dispatchEvent(new StorageEvent('storage', { key: 'userSettings', newValue: JSON.stringify(userSettings) }));
});

// Apply initial settings
applySettings();
</script>

</body>
</html>